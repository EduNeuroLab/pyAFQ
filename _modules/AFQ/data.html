
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>AFQ.data &#8212; AFQ 0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/autoapi.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for AFQ.data</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">op</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">import</span> <span class="nn">botocore</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>
<span class="kn">import</span> <span class="nn">dipy.data</span> <span class="k">as</span> <span class="nn">dpd</span>
<span class="kn">from</span> <span class="nn">dipy.data.fetcher</span> <span class="k">import</span> <span class="n">_make_fetcher</span>

<span class="kn">from</span> <span class="nn">AFQ.utils.streamlines</span> <span class="k">import</span> <span class="n">read_trk</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;fetch_callosum_templates&quot;</span><span class="p">,</span> <span class="s2">&quot;read_callosum_templates&quot;</span><span class="p">,</span>
           <span class="s2">&quot;fetch_templates&quot;</span><span class="p">,</span> <span class="s2">&quot;read_templates&quot;</span><span class="p">,</span> <span class="s2">&quot;fetch_hcp&quot;</span><span class="p">,</span>
           <span class="s2">&quot;fetch_stanford_hardi_tractography&quot;</span><span class="p">,</span>
           <span class="s2">&quot;read_stanford_hardi_tractography&quot;</span><span class="p">,</span>
           <span class="s2">&quot;organize_stanford_data&quot;</span><span class="p">]</span>

<span class="n">afq_home</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="s1">&#39;AFQ_data&#39;</span><span class="p">)</span>

<span class="n">baseurl</span> <span class="o">=</span> <span class="s2">&quot;https://ndownloader.figshare.com/files/&quot;</span>

<span class="n">callosum_fnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Callosum_midsag.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;L_AntFrontal.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;L_Motor.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;L_Occipital.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;L_Orbital.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;L_PostParietal.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;L_SupFrontal.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;L_SupParietal.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;L_Temporal.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;R_AntFrontal.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;R_Motor.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;R_Occipital.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;R_Orbital.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;R_PostParietal.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;R_SupFrontal.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;R_SupParietal.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;R_Temporal.nii.gz&quot;</span><span class="p">]</span>

<span class="n">callosum_remote_fnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;5273794&quot;</span><span class="p">,</span> <span class="s2">&quot;5273797&quot;</span><span class="p">,</span> <span class="s2">&quot;5273800&quot;</span><span class="p">,</span> <span class="s2">&quot;5273803&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273806&quot;</span><span class="p">,</span> <span class="s2">&quot;5273809&quot;</span><span class="p">,</span> <span class="s2">&quot;5273812&quot;</span><span class="p">,</span> <span class="s2">&quot;5273815&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273821&quot;</span><span class="p">,</span> <span class="s2">&quot;5273818&quot;</span><span class="p">,</span> <span class="s2">&quot;5273824&quot;</span><span class="p">,</span> <span class="s2">&quot;5273827&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273830&quot;</span><span class="p">,</span> <span class="s2">&quot;5273833&quot;</span><span class="p">,</span> <span class="s2">&quot;5273836&quot;</span><span class="p">,</span> <span class="s2">&quot;5273839&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273842&quot;</span><span class="p">]</span>

<span class="n">callosum_md5_hashes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;709fa90baadeacd64f1d62b5049a4125&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;987c6169de807c4e93dc2cbd7a25d506&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;0da114123d0b0097b96fe450a459550b&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;6d845bd10504f67f1dc17f9000076d7e&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;e16c7873ef4b08d26b77ef746dab8237&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;47193fd4df1ea17367817466de798b90&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;7e78bf9671e6945f4b2f5e7c30595a3c&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;8adbb947377ff7b484c88d8c0ffc2125&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;0fd981a4d0847e0642ff96e84fe44e47&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;87c4855efa406d8fb004cffb8259180e&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;c7969bcf5f2343fd9ce9c49b336cf14c&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;bb4372b88991932150205ffb22aa6cb7&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;d198d4e7db18ddc7236cf143ecb8342e&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;d0f6edef64b0c710c92e634496085dda&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;85eaee44665f244db5adae2e259833f6&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;25f24eb22879a05d12bda007c81ea55a&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;2664e0b8c2d9c59f13649a89bfcce399&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="fetch_callosum_templates"><a class="viewcode-back" href="../../autoapi/AFQ/data/index.html#AFQ.data.fetch_callosum_templates">[docs]</a><span class="n">fetch_callosum_templates</span> <span class="o">=</span> <span class="n">_make_fetcher</span><span class="p">(</span><span class="s2">&quot;fetch_callosum_templates&quot;</span><span class="p">,</span>
                                         <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">afq_home</span><span class="p">,</span>
                                                 <span class="s1">&#39;callosum_templates&#39;</span><span class="p">),</span>
                                         <span class="n">baseurl</span><span class="p">,</span> <span class="n">callosum_remote_fnames</span><span class="p">,</span>
                                         <span class="n">callosum_fnames</span><span class="p">,</span>
                                         <span class="n">md5_list</span><span class="o">=</span><span class="n">callosum_md5_hashes</span><span class="p">,</span>
                                         <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Download AFQ callosum templates&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="read_callosum_templates"><a class="viewcode-back" href="../../autoapi/AFQ/data/index.html#AFQ.data.read_callosum_templates">[docs]</a><span class="k">def</span> <span class="nf">read_callosum_templates</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Load AFQ callosum templates from file</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict with: keys: names of template ROIs and values: nibabel Nifti1Image</span>
<span class="sd">    objects from each of the ROI nifti files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">files</span><span class="p">,</span> <span class="n">folder</span> <span class="o">=</span> <span class="n">fetch_callosum_templates</span><span class="p">()</span>
    <span class="n">template_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">template_dict</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">template_dict</span></div>


<span class="n">template_fnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ATR_roi1_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ATR_roi1_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ATR_roi2_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ATR_roi2_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ATR_L_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ATR_R_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;CGC_roi1_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;CGC_roi1_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;CGC_roi2_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;CGC_roi2_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;CGC_L_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;CGC_R_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;CST_roi1_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;CST_roi1_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;CST_roi2_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;CST_roi2_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;CST_L_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;CST_R_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;FA_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;FA_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;FA_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;FP_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;FP_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;FP_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;HCC_roi1_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;HCC_roi1_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;HCC_roi2_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;HCC_roi2_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;HCC_L_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;HCC_R_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;IFO_roi1_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;IFO_roi1_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;IFO_roi2_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;IFO_roi2_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;IFO_L_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;IFO_R_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ILF_roi1_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ILF_roi1_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ILF_roi2_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ILF_roi2_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ILF_L_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ILF_R_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;SLF_roi1_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;SLF_roi1_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;SLF_roi2_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;SLF_roi2_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;SLFt_roi2_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;SLFt_roi2_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;SLF_L_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;SLF_R_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;UNC_roi1_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;UNC_roi1_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;UNC_roi2_L.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;UNC_roi2_R.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;UNC_L_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;UNC_R_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ARC_L_prob_map.nii.gz&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ARC_R_prob_map.nii.gz&quot;</span><span class="p">]</span>


<span class="n">template_remote_fnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;5273680&quot;</span><span class="p">,</span> <span class="s2">&quot;5273683&quot;</span><span class="p">,</span> <span class="s2">&quot;5273686&quot;</span><span class="p">,</span> <span class="s2">&quot;5273689&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;11458274&quot;</span><span class="p">,</span> <span class="s2">&quot;11458277&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273695&quot;</span><span class="p">,</span> <span class="s2">&quot;5273692&quot;</span><span class="p">,</span> <span class="s2">&quot;5273698&quot;</span><span class="p">,</span> <span class="s2">&quot;5273701&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;11458268&quot;</span><span class="p">,</span> <span class="s2">&quot;11458271&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273704&quot;</span><span class="p">,</span> <span class="s2">&quot;5273707&quot;</span><span class="p">,</span> <span class="s2">&quot;5273710&quot;</span><span class="p">,</span> <span class="s2">&quot;5273713&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;11458262&quot;</span><span class="p">,</span> <span class="s2">&quot;11458265&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273716&quot;</span><span class="p">,</span> <span class="s2">&quot;5273719&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;11458220&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273722&quot;</span><span class="p">,</span> <span class="s2">&quot;5273725&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;11458226&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273728&quot;</span><span class="p">,</span> <span class="s2">&quot;5273731&quot;</span><span class="p">,</span> <span class="s2">&quot;5273734&quot;</span><span class="p">,</span> <span class="s2">&quot;5273746&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;11458259&quot;</span><span class="p">,</span> <span class="s2">&quot;11458256&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273737&quot;</span><span class="p">,</span> <span class="s2">&quot;5273740&quot;</span><span class="p">,</span> <span class="s2">&quot;5273743&quot;</span><span class="p">,</span> <span class="s2">&quot;5273749&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;11458250&quot;</span><span class="p">,</span> <span class="s2">&quot;11458253&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273752&quot;</span><span class="p">,</span> <span class="s2">&quot;5273755&quot;</span><span class="p">,</span> <span class="s2">&quot;5273758&quot;</span><span class="p">,</span> <span class="s2">&quot;5273761&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;11458244&quot;</span><span class="p">,</span> <span class="s2">&quot;11458247&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273764&quot;</span><span class="p">,</span> <span class="s2">&quot;5273767&quot;</span><span class="p">,</span> <span class="s2">&quot;5273770&quot;</span><span class="p">,</span> <span class="s2">&quot;5273773&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273776&quot;</span><span class="p">,</span> <span class="s2">&quot;5273791&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;11458238&quot;</span><span class="p">,</span> <span class="s2">&quot;11458241&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;5273779&quot;</span><span class="p">,</span> <span class="s2">&quot;5273782&quot;</span><span class="p">,</span> <span class="s2">&quot;5273785&quot;</span><span class="p">,</span> <span class="s2">&quot;5273788&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;11458223&quot;</span><span class="p">,</span> <span class="s2">&quot;11458229&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;11458232&quot;</span><span class="p">,</span> <span class="s2">&quot;11458235&quot;</span><span class="p">]</span>


<span class="n">template_md5_hashes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;6b7aaed1a2982fd0ea436a223133908b&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;fd60d46d4e3cbd906c86e4c9e4fd6e2a&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;3aba60b169a35c38640de4ec29d362c8&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;12716a5688a1809fbaed1d58d2e68b59&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;c5637f471df861d9bbb45604db34770b&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;850cc4c04d7241747063fe3cd440b2ce&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;8e8973bc7838c8744914d402f52d91ca&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;c5fa4e6e685e695c006823b6784d2407&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;e1fab77f21d5303ed52285f015e24f0b&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;5f89defec3753fd75cd688c7bfb20a36&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;a4f3cd65b06fb25f63d5dab7592f00f2&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;7e73ab02db30a3ad6bd9e82148c2486e&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;f9db3154955a20b67c2dda758800d14c&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;73941510c798c1ed1b03e2bd481cd5c7&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;660cdc031ee0716d60159c7d933119ea&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;660cdc031ee0716d60159c7d933119ea&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;fd012bc89f6bed7bd54530195496bac4&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;3406906a86e633cc102127cf210a1063&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;9040a7953dcbbf131d135c866182d8ef&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;a72e17194824fcd838a594a2eb50c72e&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;627d7bb2e6d55f8243da815a36d9ff1a&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;55adbe9b8279185eedbe342149e1ff90&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;5a7412a3cf0fb185eec53d1989df2f7c&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;1aa36e83ae7b5555bb19d776ede9c18d&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;ba453196ff179b0e31172806e313b52c&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;d85c6574526b296935f34bf4f65cd493&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;9b81646317f59c7db087f27e2f85679e&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;9806e82c250e4604534b96917f87b7e8&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;213d3fb1ccd756d878f9b50b765b1c8f&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;f1e7e6bc51aa0aa279c54fb3805fb5e3&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;0e68a9feaaddcc9b4d667c2f15903368&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;d45020a87ee4bb496edd350631d91f6a&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;75c2c911826ec4b23159f9bd80e3c039&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;55d616ea9e0c646adc1aafa0f5fbe625&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;dee83fa6b03cfa5e0f5c965953aa6778&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;a13eef7059c98568adfefbab660e434e&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;045b7d5c6341997f3f0120c3a4212ad8&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;d174b1359ba982b03840436c93b7bbb4&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;fff9753f394fc4c73fb2ae40b3b4dde0&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;cd278b4dd6ff77481ea9ac16485a5ae2&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;7bdf5111265107091c7a2fca9215de30&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;7d4a43714504e6e930f922c9bc2a13d5&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;af2bcedf47e193686af329b9a8e259da&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;9a1122943579d11ba169d3ad87a75625&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;627903f7a06627bfd4153dc9245fa390&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;1714cd7f989c3435bdd5a2076e6272a0&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;1fa2114049707a4e05b53f9d95730375&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;b6663067d5ea53c70cb8803948f8adf7&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;d3e068997ebc60407bd6e9576e47dede&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;27ecfbd1d2f98213e52d73b7d70fe0e7&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;fa141bb2d951bec486916acda3652d95&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;d391d073e86e28588be9a6d01b2e7a82&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;a3e085562e6b8111c7ebc358f9450c8b&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;d65c67910807504735e034f7ea92d590&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;93cb24a9128db1a6c34a09eaf79fe7f0&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;71a7455cb4062dc39b1677c118c7b5a5&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;19590c712f1776da1fdba64d4eb7f1f6&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;04d5af0feb2c1b5b52a87ccbbf148e4b&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;53c277be990d00f7de04f2ea35e74d73&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="fetch_templates"><a class="viewcode-back" href="../../autoapi/AFQ/data/index.html#AFQ.data.fetch_templates">[docs]</a><span class="n">fetch_templates</span> <span class="o">=</span> <span class="n">_make_fetcher</span><span class="p">(</span><span class="s2">&quot;fetch_templates&quot;</span><span class="p">,</span>
                                <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">afq_home</span><span class="p">,</span> <span class="s1">&#39;templates&#39;</span><span class="p">),</span>
                                <span class="n">baseurl</span><span class="p">,</span> <span class="n">template_remote_fnames</span><span class="p">,</span>
                                <span class="n">template_fnames</span><span class="p">,</span> <span class="n">md5_list</span><span class="o">=</span><span class="n">template_md5_hashes</span><span class="p">,</span>
                                <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Download AFQ templates&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="read_templates"><a class="viewcode-back" href="../../autoapi/AFQ/data/index.html#AFQ.data.read_templates">[docs]</a><span class="k">def</span> <span class="nf">read_templates</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Load AFQ templates from file</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict with: keys: names of template ROIs and values: nibabel Nifti1Image</span>
<span class="sd">    objects from each of the ROI nifti files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">files</span><span class="p">,</span> <span class="n">folder</span> <span class="o">=</span> <span class="n">fetch_templates</span><span class="p">()</span>
    <span class="n">template_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">template_dict</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">template_dict</span></div>


<div class="viewcode-block" id="fetch_hcp"><a class="viewcode-back" href="../../autoapi/AFQ/data/index.html#AFQ.data.fetch_hcp">[docs]</a><span class="k">def</span> <span class="nf">fetch_hcp</span><span class="p">(</span><span class="n">subjects</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch HCP diffusion data and arrange it in a manner that resembles the</span>
<span class="sd">    BIDS [1]_ specification.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    subjects : list</span>
<span class="sd">       Each item is an integer, identifying one of the HCP subjects</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict with remote and local names of these files.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    To use this function, you need to have a file &#39;~/.aws/credentials&#39;, that</span>
<span class="sd">    includes a section:</span>

<span class="sd">    [hcp]</span>
<span class="sd">    AWS_ACCESS_KEY_ID=XXXXXXXXXXXXXXXX</span>
<span class="sd">    AWS_SECRET_ACCESS_KEY=XXXXXXXXXXXXXXXX</span>

<span class="sd">    The keys are credentials that you can get from HCP (see https://wiki.humanconnectome.org/display/PublicData/How+To+Connect+to+Connectome+Data+via+AWS)  # noqa</span>

<span class="sd">    Local filenames are changed to match our expected conventions.</span>

<span class="sd">    .. [1] Gorgolewski et al. (2016). The brain imaging data structure,</span>
<span class="sd">           a format for organizing and describing outputs of neuroimaging</span>
<span class="sd">           experiments. Scientific Data, 3::160044. DOI: 10.1038/sdata.2016.44.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">boto3</span><span class="o">.</span><span class="n">setup_default_session</span><span class="p">(</span><span class="n">profile_name</span><span class="o">=</span><span class="s1">&#39;hcp&#39;</span><span class="p">)</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">bucket</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="s1">&#39;hcp-openaccess&#39;</span><span class="p">)</span>
        <span class="c1"># This will trigger the client error in case this S3 bucket</span>
        <span class="c1"># doesn&#39;t exist</span>
        <span class="nb">list</span><span class="p">(</span><span class="n">bucket</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
    <span class="k">except</span> <span class="n">botocore</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ClientError</span><span class="p">:</span>
        <span class="n">bucket</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="s1">&#39;hcp-openaccess-temp&#39;</span><span class="p">)</span>

    <span class="n">base_dir</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">afq_home</span><span class="p">,</span> <span class="s1">&#39;HCP&#39;</span><span class="p">,</span> <span class="s1">&#39;derivatives&#39;</span><span class="p">,</span> <span class="s1">&#39;preafq&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">base_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">data_files</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">subjects</span><span class="p">:</span>
        <span class="c1"># We make a single session folder per subject for this case, because</span>
        <span class="c1"># AFQ api expects session structure:</span>
        <span class="n">sub_dir</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;sub-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">subject</span><span class="p">)</span>
        <span class="n">sess_dir</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sub_dir</span><span class="p">,</span> <span class="s2">&quot;sess-01&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">sub_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sess_dir</span><span class="p">,</span> <span class="s1">&#39;dwi&#39;</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sess_dir</span><span class="p">,</span> <span class="s1">&#39;anat&#39;</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">data_files</span><span class="p">[</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sess_dir</span><span class="p">,</span> <span class="s1">&#39;dwi&#39;</span><span class="p">,</span> <span class="s1">&#39;sub-</span><span class="si">%s</span><span class="s1">_dwi.bval&#39;</span> <span class="o">%</span> <span class="n">subject</span><span class="p">)]</span> <span class="o">=</span>\
            <span class="s1">&#39;HCP/</span><span class="si">%s</span><span class="s1">/T1w/Diffusion/bvals&#39;</span> <span class="o">%</span> <span class="n">subject</span>
        <span class="n">data_files</span><span class="p">[</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sess_dir</span><span class="p">,</span> <span class="s1">&#39;dwi&#39;</span><span class="p">,</span> <span class="s1">&#39;sub-</span><span class="si">%s</span><span class="s1">_dwi.bvec&#39;</span> <span class="o">%</span> <span class="n">subject</span><span class="p">)]</span> <span class="o">=</span>\
            <span class="s1">&#39;HCP/</span><span class="si">%s</span><span class="s1">/T1w/Diffusion/bvecs&#39;</span> <span class="o">%</span> <span class="n">subject</span>
        <span class="n">data_files</span><span class="p">[</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sess_dir</span><span class="p">,</span> <span class="s1">&#39;dwi&#39;</span><span class="p">,</span> <span class="s1">&#39;sub-</span><span class="si">%s</span><span class="s1">_dwi.nii.gz&#39;</span> <span class="o">%</span> <span class="n">subject</span><span class="p">)]</span> <span class="o">=</span>\
            <span class="s1">&#39;HCP/</span><span class="si">%s</span><span class="s1">/T1w/Diffusion/data.nii.gz&#39;</span> <span class="o">%</span> <span class="n">subject</span>
        <span class="n">data_files</span><span class="p">[</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sess_dir</span><span class="p">,</span> <span class="s1">&#39;anat&#39;</span><span class="p">,</span> <span class="s1">&#39;sub-</span><span class="si">%s</span><span class="s1">_T1w.nii.gz&#39;</span> <span class="o">%</span> <span class="n">subject</span><span class="p">)]</span> <span class="o">=</span>\
            <span class="s1">&#39;HCP/</span><span class="si">%s</span><span class="s1">/T1w/T1w_acpc_dc.nii.gz&#39;</span> <span class="o">%</span> <span class="n">subject</span>
        <span class="n">data_files</span><span class="p">[</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sess_dir</span><span class="p">,</span> <span class="s1">&#39;anat&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;sub-</span><span class="si">%s</span><span class="s1">_aparc+aseg.nii.gz&#39;</span> <span class="o">%</span> <span class="n">subject</span><span class="p">)]</span> <span class="o">=</span>\
            <span class="s1">&#39;HCP/</span><span class="si">%s</span><span class="s1">/T1w/aparc+aseg.nii.gz&#39;</span> <span class="o">%</span> <span class="n">subject</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_files</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">op</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">bucket</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">data_files</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">k</span><span class="p">)</span>
    <span class="c1"># Create the BIDS dataset description file text</span>
    <span class="n">dataset_description</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s2">&quot;BIDSVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
         <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;HCP&quot;</span><span class="p">,</span>
         <span class="s2">&quot;Acknowledgements&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;Data were provided by the Human Connectome Project, WU-Minn Consortium (Principal Investigators: David Van Essen and Kamil Ugurbil; 1U54MH091657) funded by the 16 NIH Institutes and Centers that support the NIH Blueprint for Neuroscience Research; and by the McDonnell Center for Systems Neuroscience at Washington University.&quot;&quot;&quot;</span><span class="p">,</span>  <span class="c1"># noqa</span>
         <span class="s2">&quot;Subjects&quot;</span><span class="p">:</span> <span class="n">subjects</span><span class="p">}</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;dataset_description.json&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">dataset_description</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data_files</span></div>


<span class="n">stanford_hardi_tractography_remote_fnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;5325715&quot;</span><span class="p">,</span> <span class="s2">&quot;5325718&quot;</span><span class="p">]</span>
<span class="n">stanford_hardi_tractography_hashes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;6f4bdae702031a48d1cd3811e7a42ef9&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;f20854b4f710577c58bd01072cfb4de6&#39;</span><span class="p">]</span>
<span class="n">stanford_hardi_tractography_fnames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mapping.nii.gz&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;tractography_subsampled.trk&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="fetch_stanford_hardi_tractography"><a class="viewcode-back" href="../../autoapi/AFQ/data/index.html#AFQ.data.fetch_stanford_hardi_tractography">[docs]</a><span class="n">fetch_stanford_hardi_tractography</span> <span class="o">=</span> <span class="n">_make_fetcher</span><span class="p">(</span>
    <span class="s2">&quot;fetch_stanford_hardi_tractography&quot;</span><span class="p">,</span>
    <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">afq_home</span><span class="p">,</span>
            <span class="s1">&#39;stanford_hardi_tractography&#39;</span><span class="p">),</span>
    <span class="n">baseurl</span><span class="p">,</span>
    <span class="n">stanford_hardi_tractography_remote_fnames</span><span class="p">,</span>
    <span class="n">stanford_hardi_tractography_fnames</span><span class="p">,</span>
    <span class="n">md5_list</span><span class="o">=</span><span class="n">stanford_hardi_tractography_hashes</span><span class="p">,</span>
    <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Download Stanford HARDI tractography and mapping. For testing</span>
<span class="s2">           purposes&quot;&quot;&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="read_stanford_hardi_tractography"><a class="viewcode-back" href="../../autoapi/AFQ/data/index.html#AFQ.data.read_stanford_hardi_tractography">[docs]</a><span class="k">def</span> <span class="nf">read_stanford_hardi_tractography</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">files</span><span class="p">,</span> <span class="n">folder</span> <span class="o">=</span> <span class="n">fetch_stanford_hardi_tractography</span><span class="p">()</span>
    <span class="n">files_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">files_dict</span><span class="p">[</span><span class="s1">&#39;mapping.nii.gz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
        <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">afq_home</span><span class="p">,</span>
                <span class="s1">&#39;stanford_hardi_tractography&#39;</span><span class="p">,</span>
                <span class="s1">&#39;mapping.nii.gz&#39;</span><span class="p">))</span>
    <span class="n">files_dict</span><span class="p">[</span><span class="s1">&#39;tractography_subsampled.trk&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">read_trk</span><span class="p">(</span>
        <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">afq_home</span><span class="p">,</span>
                <span class="s1">&#39;stanford_hardi_tractography&#39;</span><span class="p">,</span>
                <span class="s1">&#39;tractography_subsampled.trk&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">files_dict</span></div>


<div class="viewcode-block" id="organize_stanford_data"><a class="viewcode-back" href="../../autoapi/AFQ/data/index.html#AFQ.data.organize_stanford_data">[docs]</a><span class="k">def</span> <span class="nf">organize_stanford_data</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create the expected file-system structure for the Stanford HARDI data-set</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dpd</span><span class="o">.</span><span class="n">fetch_stanford_hardi</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">op</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">afq_home</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">afq_home</span><span class="p">)</span>
        <span class="n">base_folder</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">afq_home</span><span class="p">,</span> <span class="s1">&#39;stanford_hardi&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;derivatives&#39;</span><span class="p">,</span> <span class="s1">&#39;preafq&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">base_folder</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;stanford_hardi&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;derivatives&#39;</span><span class="p">,</span> <span class="s1">&#39;preafq&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">op</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">base_folder</span><span class="p">):</span>
        <span class="n">anat_folder</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_folder</span><span class="p">,</span> <span class="s1">&#39;sub-01&#39;</span><span class="p">,</span> <span class="s1">&#39;sess-01&#39;</span><span class="p">,</span> <span class="s1">&#39;anat&#39;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">anat_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dwi_folder</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_folder</span><span class="p">,</span> <span class="s1">&#39;sub-01&#39;</span><span class="p">,</span> <span class="s1">&#39;sess-01&#39;</span><span class="p">,</span> <span class="s1">&#39;dwi&#39;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dwi_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">t1_img</span> <span class="o">=</span> <span class="n">dpd</span><span class="o">.</span><span class="n">read_stanford_t1</span><span class="p">()</span>
        <span class="n">nib</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">t1_img</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">anat_folder</span><span class="p">,</span> <span class="s1">&#39;sub-01_sess-01_T1w.nii.gz&#39;</span><span class="p">))</span>
        <span class="n">seg_img</span> <span class="o">=</span> <span class="n">dpd</span><span class="o">.</span><span class="n">read_stanford_labels</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">nib</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">seg_img</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">anat_folder</span><span class="p">,</span>
                                  <span class="s1">&#39;sub-01_sess-01_aparc+aseg.nii.gz&#39;</span><span class="p">))</span>
        <span class="n">dwi_img</span><span class="p">,</span> <span class="n">gtab</span> <span class="o">=</span> <span class="n">dpd</span><span class="o">.</span><span class="n">read_stanford_hardi</span><span class="p">()</span>
        <span class="n">nib</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">dwi_img</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dwi_folder</span><span class="p">,</span> <span class="s1">&#39;sub-01_sess-01_dwi.nii.gz&#39;</span><span class="p">))</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dwi_folder</span><span class="p">,</span> <span class="s1">&#39;sub-01_sess-01_dwi.bvecs&#39;</span><span class="p">),</span> <span class="n">gtab</span><span class="o">.</span><span class="n">bvecs</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dwi_folder</span><span class="p">,</span> <span class="s1">&#39;sub-01_sess-01_dwi.bvals&#39;</span><span class="p">),</span> <span class="n">gtab</span><span class="o">.</span><span class="n">bvals</span><span class="p">)</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/escience-logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation_guide.html">Installing <code class="docutils literal notranslate"><span class="pre">pyAFQ</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Using pyAFQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/index.html">Sphinx AutoAPI Index</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Ariel Rokem.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
    </div>

    

    
  </body>
</html>